
The fourier series and the polynomial define one time-course of one of the x outputs.

We want to obtain the u control input (and the other x output, of course), and then
the cost function J.
Unfortunately, both sympy and maxima choke on solving the DE for U after the fourier series,
even though this DE really should be analytic.

One could easily numerically integrate the problem, as discussed in one of Nagurka and Yen's examples
- but that's boring and kinda defeats the purpose of using this high-accuracy analytic method.



x2_v = ğ›‚áµ¥*u2 + ğ›ƒáµ¥*u1 + ğ›„áµ¥*u0 - ğ›™áµ¥*x1_v - ğ›áµ¥*x0_v




dÂ²xáµ¥/dtÂ² = ğ›‚*dÂ²u/dtÂ² + ğ›ƒ*du/dt + ğ›„*u - ğ›™*dxáµ¥/dt - ğ›*xáµ¥
ğ›*xáµ¥ = ğ›‚*dÂ²u/dtÂ² + ğ›ƒ*du/dt + ğ›„*u - ğ›™*dxáµ¥/dt - dÂ²xáµ¥/dtÂ²


ğ›xáµ¥ = ğ›‚uÌˆ + ğ›ƒuÌ‡ + ğ›„u - ğ›™xÌ‡áµ¥ - xÌˆáµ¥


We approximate xáµ¥ by Nagurka, Eq. 13:

xáµ¥(t) = P(t) + Î»(t)

    5
P = âˆ‘ p_j
   j=0

    M
Î» = âˆ‘ a cos + b sin
   m=1

there is a subtlty here in that the derivative of a fourier series may not equal the term-by-term derivative.
https://math.stackexchange.com/questions/1754033/integration-and-differentiation-of-fourier-series
this is explicitly addressed in nagurka. this might be why the CASes choked - the terms that
ensure differentiability weren't known to it


ğ›‚uÌˆ + ğ›ƒuÌ‡ + ğ›„u = ğ›(P + Î»)  + ğ›™xÌ‡áµ¥ + xÌˆáµ¥


now that's nothing more than the harmonic oscillator.

http://web.uvic.ca/~monahana/ode_1_flowchart.pdf
http://web.uvic.ca/~monahana/ode_2_flowchart.pdf
a brilliant ode flowchart!

this is a nonhomogenous differential equation.
Is the ODE linear? Yes.

ğ›‚uÌˆ + ğ›ƒuÌ‡ + ğ›„u = ğ›(P + Î») + ğ›™d(P + Î»)/dt + dÂ²(P + Î»)/dtÂ²

let us put it in standard form:

uÌˆ + ğ›ƒ/ğ›‚uÌ‡ + ğ›„/ğ›‚u = (ğ›/ğ›‚)(P + Î») + (ğ›™/ğ›‚)d(P + Î»)/dt + (1/ğ›‚)dÂ²(P + Î»)/dtÂ²


The ODE is non-homogeneous.

"The solution is of form y(x) = yp(x) + yc(x) where yp(x) is a particular solution and yc(x) is
the solution of the associated homogeneous ODE."

"Find yc(x) by going back to Step 1." Homogeneous ODE:

uÌˆ + ğ›ƒ/ğ›‚uÌ‡ + ğ›„/ğ›‚u = 0

define two new constants,

A = ğ›ƒ/ğ›‚
B = ğ›„/ğ›‚

typical values for
ğ›‚=1.3e-08
ğ›ƒ=5.7
ğ›„=4e7

AÂ² - 4B = 1e17
therefore, case A:

yc(t) = câ‚e^(mâ‚t) + câ‚‚e^(mâ‚‚t)


(I knew I would mess up beta and B, man, lack of CAS is hurting).

"Is g(x) a sum/product of constants, polynomials, exponentials, and sine/cosine
functions?" Yes.
"Can find yp(x) using method of undetermined coefficients. Let the functions hi(x) be made
up of the functions in g(x) and their derivatives.
Do any of the hi(x) belong to the fundamental set y1(x), y2(x) of the homogeneous ODE?"

https://tutorial.math.lamar.edu/classes/de/undeterminedcoefficients.aspx







To double-check, we can numerically integrate.



â‚€â‚â‚‚â‚ƒâ‚„â‚…

Â²Â³

combining derivative
combining third derivative
